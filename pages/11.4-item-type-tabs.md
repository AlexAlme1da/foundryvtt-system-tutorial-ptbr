# Separando tipos de itens em abas

Agora que criamos grupos separados de itens na classe ActorSheet, podemos atualizar nossa aba de itens para substituí-la por múltiplas abas, uma para cada tipo de item. Primeiro, precisamos adicionar as novas abas à nossa navegação.

Edite o arquivo actor-sheet.html e atualize a nav para as abas para ter 4 links, como no exemplo abaixo.

```handlebars
    {{!-- ...continued... --}}
    {{!-- Sheet Tab Navigation --}}
    <nav class="sheet-tabs tabs" data-group="primary">
        <a class="item" data-tab="description">Description</a>
        <a class="item" data-tab="items">Items</a>
        <a class="item" data-tab="features">Features</a>
        <a class="item" data-tab="spells">Spells</a>
    </nav>
    {{!-- ...continued... --}}
```

Depois disso, desça até a aba de itens possuídos e mude o loop `{{#each` de `actor.items` para `actor.gear`, que é o novo array que fizemos anteriormente que inclui apenas as entidades de item com o subtipo `item`.

```handlebars
        {{!-- ...continued... --}}
        {{!-- Owned Items Tab --}}
        <div class="tab items" data-group="primary" data-tab="items">
            <ol class="items-list">
                <li class="item flexrow item-header">
                  <div class="item-image"></div>
                  <div class="item-name">Name</div>
                  <div class="item-controls">
                    <a class="item-control item-create" title="Create item" data-type="item"><i class="fas fa-plus"></i> Add item</a>
                  </div>
                </li>
            {{#each actor.gear as |item id|}}
                <li class="item flexrow" data-item-id="{{item._id}}">
                    <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/></div>
                    <h4 class="item-name">{{item.name}}</h4>
                    <div class="item-controls">
                        <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                        <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                    </div>
                </li>
            {{/each}}
            </ol>
        </div>
        {{!-- ...continued... --}}
```

Uma vez feito isso, vamos adicionar a marcação para outra aba logo abaixo da aba de itens. Esta é quase idêntica à aba de itens de antes, com as seguintes mudanças:

- A classe na aba é `features` em vez de `items`, assim como o atributo `data-tab`.
- No elemento `<a class="item-control item-create"`, o atributo `data-type` é `feature`, que instruirá este controle a criar um recurso em vez de um item.
- O loop `{{#each` está em `actor.features` em vez de `actor.gear`

```handlebars
        {{!-- ...continued... --}}
        {{!-- Owned Features Tab --}}
        <div class="tab features" data-group="primary" data-tab="features">
            <ol class="items-list">
                <li class="item flexrow item-header">
                  <div class="item-image"></div>
                  <div class="item-name">Name</div>
                  <div class="item-controls">
                    <a class="item-control item-create" title="Create item" data-type="feature"><i class="fas fa-plus"></i> Add feature</a>
                  </div>
                </li>
            {{#each actor.features as |item id|}}
                <li class="item flexrow" data-item-id="{{item._id}}">
                    <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/></div>
                    <h4 class="item-name">{{item.name}}</h4>
                    <div class="item-controls">
                        <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                        <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                    </div>
                </li>
            {{/each}}
            </ol>
        </div>
        {{!-- ...continued... --}}
```

Depois disso, vamos fazer a aba de magias. A aba de magias é um pouco diferente das outras duas abas de itens, pois para esta também queremos ordenar as magias em múltiplas linhas, uma para cada nível de magia. Revise o código abaixo atentamente e compare-o com a aba de recursos que acabamos de fazer. Depois disso, desça abaixo do exemplo de código para uma análise do que está acontecendo.

```handlebars
        {{!-- ...continued... --}}
        {{!-- Owned Spells Tab --}}
        <div class="tab spells" data-group="primary" data-tab="spells">
            <ol class="items-list">
                <li class="item flexrow item-header">
                  <div class="item-image"></div>
                  <div class="item-name">Name</div>
                  <div class="item-controls"></div>
                </li>
                {{#each actor.spells as |spells spellLevel|}}
                    <li class="item flexrow item-header">
                      <div class="item-name">Level {{spellLevel}} Spells</div>
                      <div class="item-controls">
                        <a class="item-control item-create" title="Create item" data-type="spell" data-spell-level="{{spellLevel}}"><i class="fas fa-plus"></i> Add LVL {{spellLevel}}</a>
                      </div>
                    </li>
                    {{#each spells as |item id|}}
                        <li class="item flexrow" data-item-id="{{item._id}}">
                            <div class="item-image"><img src="{{item.img}}" title="{{item.name}}" width="24" height="24"/></div>
                            <h4 class="item-name">{{item.name}}</h4>
                            <div class="item-controls">
                                <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                                <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                            </div>
                        </li>
                    {{/each}}
                {{/each}}
            </ol>
        </div>
        {{!-- ...continued... --}}
```

A princípio, parece bastante similar a equipamentos e recursos. A grande diferença é que na verdade temos dois loops, um loop externo para níveis de magia e um loop interno para itens de magia dentro desses níveis.

- Removemos o controle `item-create` da aba como um todo, já que esses seriam mais úteis se tivéssemos um por nível de magia.
- Para percorrer as chaves de nível de magia que fizemos no nosso JS anteriormente, usamos um loop each como `{{#each actor.spells as |spells spellLevel|}}`. O identificador `spells` será um array de magias, enquanto a chave `spellLevel` será o nível de magia numérico.
- Cada nível de magia tem seu próprio item de lista `item-header` com um controle `item-create` customizado para criar novas magias. Note que também tem um atributo `data-spell-level` para o qual não adicionamos nenhum código adicional no nosso JS. O método `_onItemCreate()` será capaz de interpretar `data-spell-level` como `item.spellLevel` já que estávamos pegando todo o dataset e ele corresponde ao nome da variável. Como não podemos realmente usar `data-spellLevel` como nosso nome de atributo, o Foundry tem alguma lógica adicional para poder interpretar corretamente o nome do atributo hifenizado como nossa propriedade camelCase.
- O loop interno `{{#each spells as |item id|}}` se comporta exatamente como os loops de item e recurso fizeram anteriormente.

## Próximos passos

Isso é tudo o que temos que fazer para fazer o agrupamento de itens funcionar! Embora isso funcione para separar tipos de itens em múltiplas abas e magias por nível, você poderia extrapolar essas ideias para trabalhar com quaisquer estruturas de itens que precisar. Por exemplo, e se você tivesse um campo `itemType` nos seus itens de equipamento que fosse similar ao nosso campo `spellLevel`? Com um pouco de trabalho extra, poderíamos construir uma estrutura em equipamentos com chaves como `weapon`, `armor` e `trinkets` similar às chaves numéricas que tínhamos em magias e fazer um loop muito similar para agrupar itens pelo seu `itemType`.

- **Anterior:** [Agrupando itens por tipo](https://github.com/AlexAlme1da/foundryvtt-system-tutorial-ptbr/blob/master/pages/11.3-grouping-items.md)
- **Próximo:** a ser continuado...
<!--stackedit_data:
eyJoaXN0b3J5IjpbNjM3MjYzMjU4LDIwNDU5MzY3LDUwODc2Mz
U0MSwxNDU5NzAwNjYwLC03OTc5OTQyMiw3MzA5OTgxMTZdfQ==

-->
